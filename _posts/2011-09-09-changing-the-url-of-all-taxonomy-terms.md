---
layout: post
title: Changing the URL of All Taxonomy Terms
created: 1315601293
permalink: blog/changing-url-all-taxonomy-terms
categories: drupal
tags: [taxonomy, development]
---

**Update: Thanks to [@m4olivei](https://twitter.com/m4olivei) for the improvements!**

At a client this week, I struggled to find an easy way to change the links to all taxonomy terms. I tried using [template_preprocess_field()](http://api.drupal.org/api/drupal/modules--field--field.module/function/template_preprocess_field/7), but that only covered the uses of taxonomy terms with fields. Taxonomy terms can be used in other places and it simply didn't make sense to involve the Field API; there must be something more universal.

## Solution ##

In Drupal 7 the entity system treats nodes, taxonomy, users, and comments are essentially equal objects. All have URLs that are generated by single functions. It's easy to change all of these by modifying the URI callback of a single entity type. [hook_entity_info_alter()](http://api.drupal.org/api/drupal/modules--system--system.api.php/function/hook_entity_info_alter/7) makes that possible -

{% highlight php %}
<?php
/**
 * Implementation of hook_entity_info_alter().
 *
 * Redirect any links to program taxonomy terms to their corresponding node page.
 */
function mymodule_entity_info_alter(&$entity_info) {
  $entity_info['taxonomy_term']['uri callback'] = 'mymodule_taxonomy_term_uri';
}
?>
{% endhighlight %}

Alternatively, we can easily change any internal taxonomy paths for only select vocabularies -

{% highlight php %}
<?php
/**
 * Implementation of hook_entity_info_alter().
 *
 * Redirect any links to program taxonomy terms to their corresponding node page.
 */
function mymodule_entity_info_alter(&$entity_info) {
  $entity_info['taxonomy_term']['bundles']['program']['uri callback'] = 'mymodule_taxonomy_term_uri';
}

/**
 * Entity uri callback for taxonomy terms. Add special exception to redirect users away 
 * from taxonomy term pages to the associated program node page.
 */
function mymodule_taxonomy_term_uri($term) {
  $program_node_nids = field_get_items('taxonomy_term', $term, 'field_program_node');
  return array(
    'path' => 'node/' . $program_node_nids[0]['nid'],
  );
}
?>
{% endhighlight %}
